(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{535:function(e,o,v){"use strict";v.r(o);var _=v(62),t=Object(_.a)({},(function(){var e=this,o=e.$createElement,v=e._self._c||o;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"hooks-理念"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#hooks-理念"}},[e._v("#")]),e._v(" Hooks 理念")]),e._v(" "),v("p"),v("div",{staticClass:"table-of-contents"},[v("ul",[v("li",[v("a",{attrs:{href:"#从-logo-聊起"}},[e._v("从 LOGO 聊起")])]),v("li",[v("a",{attrs:{href:"#总结"}},[e._v("总结")])])])]),v("p"),e._v(" "),v("div",{staticClass:"custom-block warning"},[v("p",{staticClass:"custom-block-title"},[e._v("注意")]),e._v(" "),v("p",[e._v("在开始本章学习前，你需要了解"),v("code",[e._v("Hooks")]),e._v("的基本用法。")]),e._v(" "),v("p",[e._v("如果你还未使用过"),v("code",[e._v("Hooks")]),e._v("，可以从"),v("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-intro.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方文档"),v("OutboundLink")],1),e._v("开始。")])]),e._v(" "),v("p",[e._v("你可以从"),v("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-intro.html#motivation",target:"_blank",rel:"noopener noreferrer"}},[e._v("这里"),v("OutboundLink")],1),e._v("了解"),v("code",[e._v("Hooks")]),e._v("的设计动机。作为一名"),v("code",[e._v("框架使用者")]),e._v("，了解"),v("code",[e._v("设计动机")]),e._v("对于我们日常开发就足够了。")]),e._v(" "),v("p",[e._v("但是，为了更好的理解"),v("code",[e._v("Hooks")]),e._v("的"),v("code",[e._v("源码架构")]),e._v("，我们需要转换身份，以"),v("code",[e._v("框架开发者")]),e._v("的角度来看待"),v("code",[e._v("Hooks")]),e._v("的"),v("code",[e._v("设计理念")]),e._v("。")]),e._v(" "),v("h2",{attrs:{id:"从-logo-聊起"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#从-logo-聊起"}},[e._v("#")]),e._v(" 从 LOGO 聊起")]),e._v(" "),v("img",{attrs:{src:e.$withBase("/images/react/logo.png"),alt:"LOGO"}}),e._v(" "),v("p",[v("code",[e._v("React")]),e._v(" "),v("code",[e._v("LOGO")]),e._v("的图案是代表"),v("code",[e._v("原子")]),e._v("（"),v("code",[e._v("atom")]),e._v("）的符号。世间万物由"),v("code",[e._v("原子")]),e._v("组成，"),v("code",[e._v("原子")]),e._v("的"),v("code",[e._v("类型")]),e._v("与"),v("code",[e._v("属性")]),e._v("决定了事物的外观与表现。")]),e._v(" "),v("p",[e._v("同样，在"),v("code",[e._v("React")]),e._v("中，我们可以将"),v("code",[e._v("UI")]),e._v("拆分为很多独立的单元，每个单元被称为"),v("code",[e._v("Component")]),e._v("。这些"),v("code",[e._v("Component")]),e._v("的"),v("code",[e._v("属性")]),e._v("与"),v("code",[e._v("类型")]),e._v("决定了"),v("code",[e._v("UI")]),e._v("的外观与表现。")]),e._v(" "),v("p",[e._v("讽刺的是，"),v("code",[e._v("原子")]),e._v("在希腊语中的意思为"),v("code",[e._v("不可分割的")]),e._v("（"),v("code",[e._v("indivisible")]),e._v("），但随后科学家在原子中发现了更小的粒子 —— 电子（"),v("code",[e._v("electron")]),e._v("）。电子可以很好的解释"),v("code",[e._v("原子")]),e._v("是如何工作的。")]),e._v(" "),v("p",[e._v("在"),v("code",[e._v("React")]),e._v("中，我们可以说"),v("code",[e._v("ClassComponent")]),e._v("是一类"),v("code",[e._v("原子")]),e._v("。")]),e._v(" "),v("p",[e._v("但对于"),v("code",[e._v("Hooks")]),e._v("来说，与其说是一类"),v("code",[e._v("原子")]),e._v("，不如说他是更贴近事物"),v("code",[e._v("运行规律")]),e._v("的"),v("code",[e._v("电子")]),e._v("。")]),e._v(" "),v("p",[e._v("我们知道，"),v("code",[e._v("React")]),e._v("的架构遵循"),v("code",[e._v("schedule - render - commit")]),e._v("的运行流程，这个流程是"),v("code",[e._v("React")]),e._v("世界最底层的"),v("code",[e._v("运行规律")]),e._v("。")]),e._v(" "),v("p",[v("code",[e._v("ClassComponent")]),e._v("作为"),v("code",[e._v("React")]),e._v("世界的"),v("code",[e._v("原子")]),e._v("，他的"),v("code",[e._v("生命周期")]),e._v("（"),v("code",[e._v("componentWillXXX")]),e._v("/"),v("code",[e._v("componentDidXXX")]),e._v("）是为了介入"),v("code",[e._v("React")]),e._v("的运行流程而实现的更上层抽象，这么做是为了方便"),v("code",[e._v("框架使用者")]),e._v("更容易上手。")]),e._v(" "),v("p",[e._v("相比于"),v("code",[e._v("ClassComponent")]),e._v("的更上层抽象，"),v("code",[e._v("Hooks")]),e._v("则更贴近"),v("code",[e._v("React")]),e._v("内部运行的各种概念（"),v("code",[e._v("state")]),e._v(" | "),v("code",[e._v("context")]),e._v(" | "),v("code",[e._v("life-cycle")]),e._v("）。")]),e._v(" "),v("p",[e._v("作为使用"),v("code",[e._v("React")]),e._v("技术栈的开发者，当我们初次学习"),v("code",[e._v("Hooks")]),e._v("时，不管是官方文档还是身边有经验的同事，总会拿"),v("code",[e._v("ClassComponent")]),e._v("的生命周期来类比"),v("code",[e._v("Hooks API")]),e._v("的执行时机。")]),e._v(" "),v("p",[e._v("这固然是很好的上手方式，但是当我们熟练运用"),v("code",[e._v("Hooks")]),e._v("时，就会发现，这两者的概念有很多割裂感，并不是同一抽象层次可以互相替代的概念。")]),e._v(" "),v("p",[e._v("比如：替代"),v("code",[e._v("componentWillReceiveProps")]),e._v("的"),v("code",[e._v("Hooks")]),e._v("是什么呢？")]),e._v(" "),v("p",[e._v("可能有些同学会回答，是"),v("code",[e._v("useEffect")]),e._v("：")]),e._v(" "),v("div",{staticClass:"language-js line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-js"}},[v("code",[v("span",{pre:!0,attrs:{class:"token function"}},[e._v("useEffect")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),v("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),v("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),v("span",{pre:!0,attrs:{class:"token string"}},[e._v("'something updated'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("props"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("something"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br"),v("span",{staticClass:"line-number"},[e._v("3")]),v("br")])]),v("p",[e._v("但是"),v("code",[e._v("componentWillReceiveProps")]),e._v("是在"),v("code",[e._v("render阶段")]),e._v("执行，而"),v("code",[e._v("useEffect")]),e._v("是在"),v("code",[e._v("commit阶段")]),e._v("完成渲染后异步执行。")]),e._v(" "),v("blockquote",[v("p",[e._v("这篇文章可以帮你更好理解"),v("code",[e._v("componentWillReceiveProps")]),e._v("："),v("a",{attrs:{href:"https://juejin.im/post/5f05a3e25188252e5c576cdb",target:"_blank",rel:"noopener noreferrer"}},[e._v("深入源码剖析 componentWillXXX 为什么 UNSAFE"),v("OutboundLink")],1)])]),e._v(" "),v("p",[e._v("所以，从源码运行规律的角度看待"),v("code",[e._v("Hooks")]),e._v("，可能是更好的角度。这也是为什么上文说"),v("code",[e._v("Hooks")]),e._v("是"),v("code",[e._v("React")]),e._v("世界的"),v("code",[e._v("电子")]),e._v("而不是"),v("code",[e._v("原子")]),e._v("的原因。")]),e._v(" "),v("blockquote",[v("p",[e._v("以上见解参考自"),v("a",{attrs:{href:"https://www.youtube.com/watch?v=dpw9EHDh2bM&feature=youtu.be",target:"_blank",rel:"noopener noreferrer"}},[e._v("React Core Team Dan 在 React Conf2018 的演讲"),v("OutboundLink")],1)])]),e._v(" "),v("h2",{attrs:{id:"总结"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),v("p",[v("code",[e._v("Concurrent Mode")]),e._v("是"),v("code",[e._v("React")]),e._v("未来的发展方向，而"),v("code",[e._v("Hooks")]),e._v("是能够最大限度发挥"),v("code",[e._v("Concurrent Mode")]),e._v("潜力的"),v("code",[e._v("Component")]),e._v("构建方式。")]),e._v(" "),v("p",[e._v("正如 Dan 在"),v("code",[e._v("React Conf 2018")]),e._v("演讲结尾所说：你可以从"),v("code",[e._v("React")]),e._v("的"),v("code",[e._v("LOGO")]),e._v("中看到这些围绕着"),v("code",[e._v("核心")]),e._v("的"),v("code",[e._v("电子飞行轨道")]),e._v("，"),v("code",[e._v("Hooks")]),e._v("可能一直就在其中。")])])}),[],!1,null,null,null);o.default=t.exports}}]);