(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{439:function(s,t,a){"use strict";a.r(t);var e=a(54),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"vite-2-react-实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vite-2-react-实践"}},[s._v("#")]),s._v(" Vite 2 + React 实践")]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#初始化项目"}},[s._v("初始化项目")])]),a("li",[a("a",{attrs:{href:"#添加-antd-爬坑记"}},[s._v("添加 Antd 爬坑记")]),a("ul",[a("li",[a("a",{attrs:{href:"#样式爬坑记"}},[s._v("样式爬坑记")])]),a("li",[a("a",{attrs:{href:"#有关使用全量-antd-包的警告分析"}},[s._v("有关使用全量 Antd 包的警告分析")])]),a("li",[a("a",{attrs:{href:"#更换主题"}},[s._v("更换主题")])])])]),a("li",[a("a",{attrs:{href:"#配置代理-能通过-restful-的方式访问"}},[s._v("配置代理，能通过 RESTFul 的方式访问")])]),a("li",[a("a",{attrs:{href:"#集成-react-router"}},[s._v("集成 React Router")])]),a("li",[a("a",{attrs:{href:"#注意别名的用法-breaking-change"}},[s._v("注意别名的用法 —— breaking change")])]),a("li",[a("a",{attrs:{href:"#用户列表页面"}},[s._v("用户列表页面")]),a("ul",[a("li",[a("a",{attrs:{href:"#新建-user-页面"}},[s._v("新建 User 页面")])]),a("li",[a("a",{attrs:{href:"#请求接口爬坑记"}},[s._v("请求接口爬坑记")])]),a("li",[a("a",{attrs:{href:"#展示数据"}},[s._v("展示数据")])]),a("li",[a("a",{attrs:{href:"#关于分页的坑"}},[s._v("关于分页的坑")])])])]),a("li",[a("a",{attrs:{href:"#what-else"}},[s._v("What Else")])])])]),a("p"),s._v(" "),a("p",[s._v("本文源码地址在 "),a("a",{attrs:{href:"https://github.com/Ivocin/vite-playgrounds/tree/main/vite-react",target:"_blank",rel:"noopener noreferrer"}},[s._v("vite-playgrounds"),a("OutboundLink")],1),s._v(" 中")]),s._v(" "),a("h2",{attrs:{id:"初始化项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化项目"}},[s._v("#")]),s._v(" 初始化项目")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" init @vitejs/app\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("选择项目名和模板：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite38.awebp"),alt:"vite/vite38.awebp"}})]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite39.awebp"),alt:"vite/vite39.awebp"}})]),s._v(" "),a("p",[s._v("安装依赖并启动：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" vite-react\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run dev\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite40.awebp"),alt:"vite/vite40.awebp"}})]),s._v(" "),a("p",[s._v("对比使用 "),a("code",[s._v("webpack")]),s._v(" 搭建 "),a("code",[s._v("React")]),s._v(" 环境可以看出，使用 "),a("code",[s._v("Vite")]),s._v(" 后，添加 "),a("code",[s._v("Babel、React、webpack-dev-server")]),s._v(" 的工作都可以省略了：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite41.awebp"),alt:"vite/vite41.awebp"}})]),s._v(" "),a("h2",{attrs:{id:"添加-antd-爬坑记"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加-antd-爬坑记"}},[s._v("#")]),s._v(" 添加 Antd 爬坑记")]),s._v(" "),a("h3",{attrs:{id:"样式爬坑记"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#样式爬坑记"}},[s._v("#")]),s._v(" 样式爬坑记")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" antd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在 "),a("code",[s._v("App.jsx")]),s._v(" 中引入 "),a("code",[s._v("antd")]),s._v(" ：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" DatePicker "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" from ‘antd’"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("保存后，页面 "),a("code",[s._v("reload")]),s._v("，注意不是 "),a("code",[s._v("HMR")]),s._v("，此时 "),a("code",[s._v("Antd")]),s._v(" 已经被引入：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite42.awebp"),alt:"vite/vite42.awebp"}})]),s._v(" "),a("p",[s._v("然后我们来添加 "),a("code",[s._v("DatePicker")]),s._v("，发现没有样式：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite43.awebp"),alt:"vite/vite43.awebp"}})]),s._v(" "),a("p",[s._v("按照 antd 官网文档指引，引入 "),a("code",[s._v("CSS")]),s._v(" 样式，稍微好了一些，但是仍然不正常：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite44.awebp"),alt:"vite/vite44.awebp"}})]),s._v(" "),a("p",[s._v("尝试引入 "),a("code",[s._v("Less")]),s._v("，直接报错：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite45.awebp"),alt:"vite/vite45.awebp"}})]),s._v(" "),a("p",[a("code",[s._v("Vite")]),s._v(" 内置支持 "),a("code",[s._v("Less")]),s._v("，但是使用需要用户手动安装 "),a("code",[s._v("Less")]),s._v("，详见官网文档："),a("a",{attrs:{href:"https://vitejs.dev/guide/features.html#css-pre-processors",target:"_blank",rel:"noopener noreferrer"}},[s._v("Features # CSS Pre-processors"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -D "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("less")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("安装完重新启动，又出现了新的错误：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite46.awebp"),alt:"vite/vite46.awebp"}})]),s._v(" "),a("p",[s._v("熟悉的味道，是 "),a("code",[s._v("Antd")]),s._v(" 的报错没错了。错误信息里提示可以看这个 "),a("a",{attrs:{href:"https://github.com/ant-design/ant-motion/issues/44",target:"_blank",rel:"noopener noreferrer"}},[s._v("Issue"),a("OutboundLink")],1),s._v("，没看这个 Issue 有两年了，发现这个 Issue 越来越大了，因为期间 "),a("code",[s._v("less-loader")]),s._v(" 升级又带来了新坑。解决方案总结起来就是在 "),a("code",[s._v("webpack")]),s._v(" 的 "),a("code",[s._v("less-loader")]),s._v(" 中开启 "),a("code",[s._v("javascriptEnabled")]),s._v("，详见这个 "),a("a",{attrs:{href:"https://github.com/Ivocin/webpack-playgrounds/commit/3fb70ba9c857ca7cd7e356a5f2c4166b3f37c3c3#diff-cb5bbe1acca2b85cc0de0a2408425020a4770aa1e949f26fea00e4581570a9c8",target:"_blank",rel:"noopener noreferrer"}},[s._v("Commit"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("那么在 "),a("code",[s._v("Vite")]),s._v(" 中怎么做呢，"),a("code",[s._v("Vite")]),s._v(" 也开放了 "),a("code",[s._v("CSS")]),s._v(" 预处理器的配置，详见官网文档 ，在 "),a("code",[s._v("vite.config.js")]),s._v(" 文件中添加如下配置：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vite.config.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n  css"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    preprocessorOptions"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      less"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        javascriptEnabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("终于，样式正常了：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite47.awebp"),alt:"vite/vite47.awebp"}})]),s._v(" "),a("h3",{attrs:{id:"有关使用全量-antd-包的警告分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#有关使用全量-antd-包的警告分析"}},[s._v("#")]),s._v(" 有关使用全量 Antd 包的警告分析")]),s._v(" "),a("p",[s._v("另外需要注意的一点是，打开调试窗口，又一个熟悉的警告又出现了，相信早期使用 "),a("code",[s._v("Antd")]),s._v(" 开发的同学都不陌生：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite48.awebp"),alt:"vite/vite48.awebp"}})]),s._v(" "),a("p",[s._v("原来的项目使用的是 "),a("code",[s._v("webpack")]),s._v("，在 "),a("code",[s._v("webpack@2")]),s._v(" 之后，就支持 "),a("code",[s._v("ES")]),s._v(" 模块的"),a("code",[s._v("tree shaking")]),s._v(" 了，这个警告不会出现。")]),s._v(" "),a("p",[s._v("而在 "),a("code",[s._v("Vite")]),s._v(" 中，我们可以查看"),a("a",{attrs:{href:"https://vitejs.dev/guide/features.html#npm-dependency-resolving-and-pre-bundling",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1),s._v("，Vite 会对 "),a("code",[s._v("npm")]),s._v(" 依赖进行预构建并重写为合法的 "),a("code",[s._v("url")]),s._v("。在本项目中，"),a("code",[s._v("Vite")]),s._v(" 将 "),a("code",[s._v("Antd")]),s._v(" 预构建到 "),a("code",[s._v("/node_moduls/.vite")]),s._v(" 文件夹，并且将 "),a("code",[s._v("url")]),s._v(" 重写为 "),a("code",[s._v("/node_modules/.vite/antd.js?v=d2a18218")]),s._v("，因此会出现这个警告。")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite49.awebp"),alt:"vite/vite49.awebp"}})]),s._v(" "),a("p",[s._v("不过不用担心，在生产包仍然会进行 "),a("code",[s._v("tree shaking")]),s._v("。而开发环境即使引入全量的 "),a("code",[s._v("Antd")]),s._v(" 包，"),a("code",[s._v("Vite")]),s._v(" 基于 "),a("code",[s._v("esbuild")]),s._v(" 的预编译速度超快，而且之后浏览器会缓存住这个包，开发体验不降反升，这个警告就可以忽略了。")]),s._v(" "),a("h3",{attrs:{id:"更换主题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更换主题"}},[s._v("#")]),s._v(" 更换主题")]),s._v(" "),a("p",[s._v("按照官网的指引，使用 "),a("code",[s._v("less")]),s._v(" 的 "),a("code",[s._v("modifyVar")]),s._v(" 来覆盖 "),a("code",[s._v("less")]),s._v(" 变量，从而达到改变主题的目的，"),a("a",{attrs:{href:"https://ant.design/docs/react/customize-theme-cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("定制主题 - Ant Design"),a("OutboundLink")],1),s._v("\n和 "),a("code",[s._v("webpack")]),s._v(" 配置在 "),a("code",[s._v("less-loader")]),s._v(" 里不同， 在 "),a("code",[s._v("Vite")]),s._v(" 中则简单很多，仍然在 "),a("code",[s._v("less")]),s._v(" 的 "),a("code",[s._v("option")]),s._v(" 里配置就可以了：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vite.config.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n      less"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        javascriptEnabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        modifyVars"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"primary-color"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#1DA57A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"link-color"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#1DA57A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"border-radius-base"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2px"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("可以看到样式生效了：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite50.awebp"),alt:"vite/vite50.awebp"}})]),s._v(" "),a("p",[s._v("按照这个思路，我们修改为暗黑主题也比较简单了：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" defineConfig "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vite'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" reactRefresh "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@vitejs/plugin-react-refresh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" getThemeVariables "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'antd/dist/theme'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// https://vitejs.dev/config/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("defineConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("reactRefresh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  css"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    preprocessorOptions"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      less"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        javascriptEnabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        modifyVars"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getThemeVariables")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            dark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'primary-color'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#1DA57A'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'link-color'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#1DA57A'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'border-radius-base'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2px'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("没问题，暗黑主题生效：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite51.awebp"),alt:"vite/vite51.awebp"}})]),s._v(" "),a("h2",{attrs:{id:"配置代理-能通过-restful-的方式访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置代理-能通过-restful-的方式访问"}},[s._v("#")]),s._v(" 配置代理，能通过 RESTFul 的方式访问")]),s._v(" "),a("p",[s._v("参考官网的 "),a("code",[s._v("server.proxy")]),s._v(" 配置，这里需要特别注意 "),a("code",[s._v("proxy")]),s._v(" 的写法和我们之前使用的 "),a("code",[s._v("webpack-dev-server")]),s._v(" 里面的 "),a("code",[s._v("proxy")]),s._v(" 配置稍有不同，如下：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vite.config.js")]),s._v("\n  server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/api'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        target"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://jsonplaceholder.typicode.com/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        changeOrigin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("rewrite")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("^\\/api")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("此时我们访问 http://localhost:3000/api/users ，就能访问到 jsonplaceholder.typicode.com/users 的数据了")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite52.awebp"),alt:"vite/vite52.awebp"}})]),s._v(" "),a("h2",{attrs:{id:"集成-react-router"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成-react-router"}},[s._v("#")]),s._v(" 集成 React Router")]),s._v(" "),a("p",[s._v("下面我们来添加菜单和路由，首先引入 React Router：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i react-router-dom\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("新建 "),a("code",[s._v("index.jsx")]),s._v(" 文件：")]),s._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" React "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'react'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" BrowserRouter "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" Router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Switch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Link "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'react-router-dom'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" App "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./App'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Router")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[s._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Switch")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[s._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Route")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("path")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("/app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[s._v("\n          ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("App")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[s._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Route")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[s._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Switch")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[s._v("\n    ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Router")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("修改 "),a("code",[s._v("main.jsx")]),s._v(" 文件，将 "),a("code",[s._v("App")]),s._v(" 替换为 "),a("code",[s._v("Index")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-diff line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[s._v("import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\n"),a("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[a("span",{pre:!0,attrs:{class:"token prefix deleted"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(" import App from './App'\n")])]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[a("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(" import Index from './index'\n")])]),s._v("\nReactDOM.render(\n"),a("span",{pre:!0,attrs:{class:"token unchanged"}},[a("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(" <React.StrictMode>\n")])]),a("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[a("span",{pre:!0,attrs:{class:"token prefix deleted"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v("   <App />\n")])]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[a("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v("   <Index />\n")])]),a("span",{pre:!0,attrs:{class:"token unchanged"}},[a("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(" </React.StrictMode>,\n")]),a("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(" document.getElementById('root')\n")])]),s._v(")\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("此时访问 http://localhost:3000/app 可以访问到 App 页面，路由生效。")]),s._v(" "),a("p",[s._v("我们再来增加一个菜单，新建 Layout.jsx 文件：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" React "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'react'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" Menu "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'antd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" Link "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'react-router-dom'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Layout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Menu selectedKeys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"App"')]),s._v(" mode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"horizontal"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Menu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Item key"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"App"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Link to"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/app"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("App"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Link"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Menu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Item"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Menu"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("最后在 index.jsx 引入 Layout 文件，以上过程详见 这个 "),a("a",{attrs:{href:"https://github.com/Ivocin/vite-playgrounds/commit/728acc2133e1a542e37b1b4bf09f0bd18323c46c",target:"_blank",rel:"noopener noreferrer"}},[s._v("Commit"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"注意别名的用法-breaking-change"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意别名的用法-breaking-change"}},[s._v("#")]),s._v(" 注意别名的用法 —— breaking change")]),s._v(" "),a("p",[s._v("注意 "),a("code",[s._v("Vite@2")]),s._v(" 的 "),a("code",[s._v("UserConfig.alias")]),s._v(" 已经过时，改为使用 "),a("code",[s._v("resolve.alias")]),s._v(" 替代，写法也和 Vite@1 不一样，详见 "),a("a",{attrs:{href:"https://vitejs.dev/config/#resolve-alias",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网文档 - resolve-alias"),a("OutboundLink")],1),s._v(" 和 "),a("a",{attrs:{href:"https://github.com/rollup/plugins/tree/master/packages/alias#regular-expression-aliases",target:"_blank",rel:"noopener noreferrer"}},[s._v("rollup plugins 文档"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vite.config.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" path "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n  resolve"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    alias"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        find"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("^~")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        replacement"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("然后我们调整文件结构，然后使用别名代替相对路径，详见 这个 "),a("a",{attrs:{href:"https://github.com/Ivocin/vite-playgrounds/commit/279e144ce9a26988989791f2616d3d9098f164b7",target:"_blank",rel:"noopener noreferrer"}},[s._v("Commit"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"用户列表页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户列表页面"}},[s._v("#")]),s._v(" 用户列表页面")]),s._v(" "),a("p",[s._v("接下来我们开发一个模拟真实接口的用户列表 ，参考 "),a("a",{attrs:{href:"https://juejin.cn/post/6844903672665604104",target:"_blank",rel:"noopener noreferrer"}},[s._v("umi@2 + dva，完成用户管理的 CURD 应用"),a("OutboundLink")],1),s._v(" 的步骤")]),s._v(" "),a("h3",{attrs:{id:"新建-user-页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新建-user-页面"}},[s._v("#")]),s._v(" 新建 User 页面")]),s._v(" "),a("p",[s._v("添加 User 路由和页面，详见这个 "),a("a",{attrs:{href:"https://github.com/Ivocin/vite-playgrounds/commit/7dc0b05bb2f16eb6046af1dd0b54e95fb4d30363",target:"_blank",rel:"noopener noreferrer"}},[s._v("Commit"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("p",[s._v("此时访问 http://localhost:3000/user 就能看到新增的 "),a("code",[s._v("User")]),s._v(" 页面了：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite53.awebp"),alt:"vite/vite53.awebp"}})]),s._v(" "),a("h3",{attrs:{id:"请求接口爬坑记"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求接口爬坑记"}},[s._v("#")]),s._v(" 请求接口爬坑记")]),s._v(" "),a("p",[s._v("请求接口数据，这里使用 "),a("a",{attrs:{href:"https://ahooks.js.org/zh-CN",target:"_blank",rel:"noopener noreferrer"}},[s._v("ahooks"),a("OutboundLink")],1),s._v(" 的 "),a("code",[s._v("use-request")])]),s._v(" "),a("p",[s._v("这里使用 "),a("code",[s._v("npm 7")]),s._v(" 安装 会报错：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite54.awebp"),alt:"vite/vite54.awebp"}})]),s._v(" "),a("p",[s._v("因为 "),a("code",[s._v("npm 7")]),s._v(" 会自动安装 "),a("code",[s._v("peerDependency")]),s._v("，而 "),a("code",[s._v("ahooks")]),s._v(" 的 "),a("code",[s._v("peerDependency")]),s._v(" 是 "),a("code",[s._v("react@^16.8.6")]),s._v(" ，导致与本项目的 "),a("code",[s._v("react@17")]),s._v(" 版本冲突报错，这个问题已经在 "),a("a",{attrs:{href:"https://github.com/alibaba/hooks/pull/871",target:"_blank",rel:"noopener noreferrer"}},[s._v("这个 pr"),a("OutboundLink")],1),s._v(" 里修复了，但是目前还没有发包，暂时使用 "),a("code",[s._v("yarn")]),s._v(" 绕过这个问题：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" @ahooksjs/use-request\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("现在就可以使用 "),a("code",[s._v("use-request")]),s._v(" 请求 "),a("code",[s._v("/api/users")]),s._v(" 获取用户信息了：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" loading "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/api/users'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"展示数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#展示数据"}},[s._v("#")]),s._v(" 展示数据")]),s._v(" "),a("p",[s._v("接口请求的坑填好后，就可以展示用户信息了。我们来添加一个表格展示用户信息，详见 这个 "),a("a",{attrs:{href:"https://github.com/Ivocin/vite-playgrounds/commit/6979cbc55f818baccc01eb2842913f1e7cca0804",target:"_blank",rel:"noopener noreferrer"}},[s._v("Commit"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("p",[a("code",[s._v("use-request")]),s._v(" 返回了 "),a("code",[s._v("loading")]),s._v("，再结合 "),a("code",[s._v("antd table")]),s._v(" 组件的 "),a("code",[s._v("loading")]),s._v("，处理 "),a("code",[s._v("loading")]),s._v(" 就很方便了：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite55.awebp"),alt:"vite/vite55.awebp"}})]),s._v(" "),a("p",[s._v("至此，模拟接口请求数据的页面就完成了。")]),s._v(" "),a("h3",{attrs:{id:"关于分页的坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于分页的坑"}},[s._v("#")]),s._v(" 关于分页的坑")]),s._v(" "),a("p",[s._v("由于我们接口采用模拟接口，分页信息在 "),a("code",[s._v("Response Headers")]),s._v(" 里面，请求 "),a("a",{attrs:{href:"http://jsonplaceholder.typicode.com/users?_page=1&_limit=5",target:"_blank",rel:"noopener noreferrer"}},[s._v("jsonplaceholder.typicode.com/users?_page…"),a("OutboundLink")],1),s._v(" 可以看到：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite56.awebp"),alt:"vite/vite56.awebp"}})]),s._v(" "),a("p",[s._v("查看了 "),a("code",[s._v("ahooks")]),s._v(" 的 "),a("code",[s._v("API")]),s._v("，发现并没有对 "),a("code",[s._v("Response Headers")]),s._v(" 的处理功能，查看 "),a("a",{attrs:{href:"https://github.com/alibaba/hooks/blob/3a7b7d550f388c4fd0d07f975c812b626d96d27a/packages/use-request/src/index.ts",target:"_blank",rel:"noopener noreferrer"}},[s._v("源码"),a("OutboundLink")],1),s._v(" 发现确实目前没有办法拿到 "),a("code",[s._v("Headers")]),s._v(" 里的值：")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:s.$withBase("/images/vite/vite57.awebp"),alt:"vite/vite57.awebp"}})]),s._v(" "),a("p",[s._v("真实接口一般分页信息都会在 "),a("code",[s._v("Response Body")]),s._v(" 中，分页数据就很容易处理了，这个坑就不费时间填了。")]),s._v(" "),a("h2",{attrs:{id:"what-else"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#what-else"}},[s._v("#")]),s._v(" What Else")]),s._v(" "),a("p",[s._v("当然没有结束，不过剩下的过程就比较常规了，罗列如下：")]),s._v(" "),a("ul",[a("li",[s._v("集成 Redux，或者使用封装过的 dva.js")]),s._v(" "),a("li",[s._v("约定式路由")]),s._v(" "),a("li",[s._v("还记得 "),a("code",[s._v("babel-plugin-import")]),s._v(" 吗，在 Vite 中，如果想样式按需加载，可以尝试使用这个插件："),a("code",[s._v("vite-plugin-style-import")]),s._v("，现在已经支持 Vite 2 了")]),s._v(" "),a("li",[s._v("想使用 "),a("code",[s._v("TypeScript")]),s._v("，可以使用 "),a("code",[s._v("@vitejs/create-app")]),s._v(" 的 "),a("code",[s._v("react-ts")]),s._v(" 模板，然后按照本文的步骤配置即可")]),s._v(" "),a("li",[a("code",[s._v("Production Mode、SSR")]),s._v("，参照官网配置即可")])])])}),[],!1,null,null,null);t.default=n.exports}}]);