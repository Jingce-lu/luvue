(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{488:function(s,t,a){"use strict";a.r(t);var e=a(65),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"如何在-node-js-中使用-import-export-的三种方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何在-node-js-中使用-import-export-的三种方法"}},[s._v("#")]),s._v(" 如何在 Node.js 中使用 import / export 的三种方法")]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#_1-使用-babel-register"}},[s._v("1. 使用 babel-register")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1-1-下载必须的包"}},[s._v("1.1 下载必须的包")])]),a("li",[a("a",{attrs:{href:"#_1-2-修改你的-server-js"}},[s._v("1.2 修改你的 server.js")])]),a("li",[a("a",{attrs:{href:"#新增一个-start-js-文件"}},[s._v("新增一个 start.js 文件")])])])]),a("li",[a("a",{attrs:{href:"#_2-使用-babel-node-命令"}},[s._v("2. 使用 babel-node 命令")])]),a("li",[a("a",{attrs:{href:"#_3-来自-node-js-官方的力量"}},[s._v("3. 来自 Node.js 官方的力量")]),a("ul",[a("li",[a("a",{attrs:{href:"#_3-1-改写-server-js"}},[s._v("3.1 改写 server.js")])]),a("li",[a("a",{attrs:{href:"#_3-2-启动文件"}},[s._v("3.2 启动文件")])])])])])]),a("p"),s._v(" "),a("p",[s._v("下面我来介绍三种方法可以让我们在 Node.js 中使用 "),a("code",[s._v("import/export")]),s._v(" 。")]),s._v(" "),a("blockquote",[a("p",[s._v("注：第 1、2 种方法均是借助 "),a("code",[s._v("babel")]),s._v("，需要注意的是文章使用的 babel 版本 < 7。从 babel 7.X 版本开始，部分包名、用法发生了些许变化，大体与 7 之前的用法类似，详细请到官方手册学习 7.X 版本的改动（Babel 踩坑总结(三) —— 7.X 版本升级是我对 7.X 版本三大改动的总结）")])]),s._v(" "),a("h2",{attrs:{id:"_1-使用-babel-register"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-使用-babel-register"}},[s._v("#")]),s._v(" 1. 使用 babel-register")]),s._v(" "),a("h3",{attrs:{id:"_1-1-下载必须的包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-下载必须的包"}},[s._v("#")]),s._v(" 1.1 下载必须的包")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" babel-register babel-preset-env -D\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_1-2-修改你的-server-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-修改你的-server-js"}},[s._v("#")]),s._v(" 1.2 修改你的 server.js")]),s._v(" "),a("p",[s._v("下面是一个 server.js 的例子：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Koa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'koa'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Koa")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8225")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'application is start at port 8225'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("用 "),a("code",[s._v("import")]),s._v(" 替换 "),a("code",[s._v("require")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Koa "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'koa'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Koa")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8225")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'application is start at port 8225'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("如果你现在用 "),a("code",[s._v("node server.js")]),s._v(" 跑这个文件，你会收到像这样的错误提示:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/Users/zwkkkk1/myStudy/demo/chatroom/server/app.js:1\n(function (exports, require, module, __filename, __dirname) { import Koa from 'koa'\n\n那么原来应该是 example.js 要改为 example.mjs                                                                     ^^^\n\nSyntaxError: Unexpected identifier\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("下面让我们用 babel 来解决这个问题")]),s._v(" "),a("h3",{attrs:{id:"新增一个-start-js-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增一个-start-js-文件"}},[s._v("#")]),s._v(" 新增一个 start.js 文件")]),s._v(" "),a("p",[s._v("这个文件将成为我们的入口文件，里面是一些 babel 的代码")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'babel-register'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("presets")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'env'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./server.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("注意，接下来不是 "),a("code",[s._v("node server.js")]),s._v("，而是用 "),a("code",[s._v("node start.js")]),s._v(" 来启动这个文件")]),s._v(" "),a("h2",{attrs:{id:"_2-使用-babel-node-命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用-babel-node-命令"}},[s._v("#")]),s._v(" 2. 使用 babel-node 命令")]),s._v(" "),a("p",[s._v("如果你不想添加新的文件也可以，这里需要在命令行中使用 "),a("code",[s._v("babel-node")]),s._v(" 命令。"),a("code",[s._v("babel-node")]),s._v(" 命令不是独立安装，在 Babel 7.X 版本前，需要通过安装 "),a("code",[s._v("babel-cli")]),s._v(" 包获得；在 Babel 7.X 版本，需要安装 "),a("code",[s._v("@babel/core")]),s._v("、"),a("code",[s._v("@babel/cli")]),s._v(" 两个包。")]),s._v(" "),a("blockquote",[a("p",[s._v("此处以 7.X 之前的版本举例，7.X 版本可去官网查找对应包的使用用例")])]),s._v(" "),a("p",[s._v("安装必要的插件")]),s._v(" "),a("p",[s._v("全局安装 "),a("code",[s._v("babel-cli")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" babel-cli -g\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("安装 "),a("code",[s._v("babel-preset-env")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" babel-preset-env -D\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("然后原来是 "),a("code",[s._v("node server.js")]),s._v("，改为这样调用："),a("code",[s._v("babel-node --presets env server.js")])]),s._v(" "),a("blockquote",[a("p",[s._v("需要注意的是如果只是为了 "),a("code",[s._v("babel-node")]),s._v(" 这一个命令，安装 "),a("code",[s._v("babel-cli")]),s._v(" 会加载安装很多资源和模块，出于性能考虑不推荐在生产环境使用。自己在开发调试的时候，可以鼓捣着玩玩")])]),s._v(" "),a("h2",{attrs:{id:"_3-来自-node-js-官方的力量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-来自-node-js-官方的力量"}},[s._v("#")]),s._v(" 3. 来自 Node.js 官方的力量")]),s._v(" "),a("p",[s._v("Node 9 提供了一个尚处于 "),a("code",[s._v("Experimental")]),s._v(" 阶段的模块，让我们可以抛弃 "),a("code",[s._v("babel")]),s._v(" 等一类工具的束缚，直接在 Node 环境下使用 "),a("code",[s._v("import/export")]),s._v("。")]),s._v(" "),a("blockquote",[a("p",[s._v("官方手册："),a("a",{attrs:{href:"http://nodejs.cn/api/esm.html#esm_ecmascript_modules",target:"_blank",rel:"noopener noreferrer"}},[s._v("ECMAScript Modules"),a("OutboundLink")],1),a("br"),s._v("\n一个不错的教程："),a("a",{attrs:{href:"https://github.com/ChenShenhai/blog/issues/24",target:"_blank",rel:"noopener noreferrer"}},[s._v("Node 9 下 import/export 的丝般顺滑使用"),a("OutboundLink")],1),a("br"),s._v("\n有兴趣的可以去了解一下，嫌字多的可以继续往下看看我总结的使用方法")])]),s._v(" "),a("p",[s._v("用前须知")]),s._v(" "),a("ul",[a("li",[s._v("Node 版本需在 9.0 及以上")]),s._v(" "),a("li",[s._v("不加 loader 时候，使用 "),a("code",[s._v("import/export")]),s._v(" 的文件后缀名必须为 "),a("code",[s._v(".mjs")])])]),s._v(" "),a("p",[s._v("举个例子，还是用上面的例子，请将代码回退到 Babel 中第一步的样子")]),s._v(" "),a("h3",{attrs:{id:"_3-1-改写-server-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-改写-server-js"}},[s._v("#")]),s._v(" 3.1 改写 server.js")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Koa "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'koa'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Koa")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8225")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'application is start at port 8225'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("和前面一样，不过将文件名改一下，从 "),a("code",[s._v("server.js")]),s._v(" 改为 "),a("code",[s._v("server.mjs")])]),s._v(" "),a("h3",{attrs:{id:"_3-2-启动文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-启动文件"}},[s._v("#")]),s._v(" 3.2 启动文件")]),s._v(" "),a("p",[s._v("执行下面代码，来启动文件")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" --experimental-modules ./server.mjs\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("注意这是引用 "),a("code",[s._v("koa")]),s._v(" 第三方模块不用做其他变化，如果要 "),a("code",[s._v("import")]),s._v(" 自己的文件，那么那个待引入的文件也要改后缀。")]),s._v(" "),a("p",[s._v("比如")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" example "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./example'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("那么原来应该是 "),a("code",[s._v("example.js")]),s._v(" 要改为 "),a("code",[s._v("example.mjs")])])])}),[],!1,null,null,null);t.default=n.exports}}]);