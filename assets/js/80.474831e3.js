(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{475:function(e,v,t){"use strict";t.r(v);var _=t(54),a=Object(_.a)({},(function(){var e=this,v=e.$createElement,t=e._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"心智模型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#心智模型"}},[e._v("#")]),e._v(" 心智模型")]),e._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#同步更新的-react"}},[e._v("同步更新的 React")])]),t("li",[t("a",{attrs:{href:"#并发更新的-react"}},[e._v("并发更新的 React")])]),t("li",[t("a",{attrs:{href:"#参考资料"}},[e._v("参考资料")])])])]),t("p"),e._v(" "),t("p",[e._v("在深入源码前，让我们先建立"),t("code",[e._v("更新机制")]),e._v("的"),t("code",[e._v("心智模型")]),e._v("。")]),e._v(" "),t("p",[e._v("在后面两节讲解源码时，我们会将代码与"),t("code",[e._v("心智模型")]),e._v("联系上，方便你更好理解。")]),e._v(" "),t("h2",{attrs:{id:"同步更新的-react"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#同步更新的-react"}},[e._v("#")]),e._v(" 同步更新的 React")]),e._v(" "),t("p",[e._v("我们可以将"),t("code",[e._v("更新机制")]),e._v("类比"),t("code",[e._v("代码版本控制")]),e._v("。")]),e._v(" "),t("p",[e._v("在没有"),t("code",[e._v("代码版本控制")]),e._v("前，我们在代码中逐步叠加功能。一切看起来井然有序，直到我们遇到了一个紧急线上 bug（红色节点）。")]),e._v(" "),t("img",{attrs:{src:e.$withBase("/images/react/git1.png"),alt:"流程1"}}),e._v(" "),t("p",[e._v("为了修复这个 bug，我们需要首先将之前的代码提交。")]),e._v(" "),t("p",[e._v("在"),t("code",[e._v("React")]),e._v("中，所有通过"),t("code",[e._v("ReactDOM.render")]),e._v("创建的应用（其他创建应用的方式参考"),t("RouterLink",{attrs:{to:"/react/03-实现篇/02-第六章状态更新/reactdom.html#react的其他入口函数"}},[e._v("ReactDOM.render 一节")]),e._v("）都是通过类似的方式"),t("code",[e._v("更新状态")]),e._v("。")],1),e._v(" "),t("p",[e._v("即没有"),t("code",[e._v("优先级")]),e._v("概念，"),t("code",[e._v("高优更新")]),e._v("（红色节点）需要排在其他"),t("code",[e._v("更新")]),e._v("后面执行。")]),e._v(" "),t("h2",{attrs:{id:"并发更新的-react"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#并发更新的-react"}},[e._v("#")]),e._v(" 并发更新的 React")]),e._v(" "),t("p",[e._v("当有了"),t("code",[e._v("代码版本控制")]),e._v("，有紧急线上 bug 需要修复时，我们暂存当前分支的修改，在"),t("code",[e._v("master分支")]),e._v("修复 bug 并紧急上线。")]),e._v(" "),t("img",{attrs:{src:e.$withBase("/images/react/git2.png"),alt:"流程2"}}),e._v(" "),t("p",[e._v("bug 修复上线后通过"),t("code",[e._v("git rebase")]),e._v("命令和"),t("code",[e._v("开发分支")]),e._v("连接上。"),t("code",[e._v("开发分支")]),e._v("基于"),t("code",[e._v("修复bug的版本")]),e._v("继续开发。")]),e._v(" "),t("img",{attrs:{src:e.$withBase("/images/react/git3.png"),alt:"流程3"}}),e._v(" "),t("p",[e._v("在"),t("code",[e._v("React")]),e._v("中，通过"),t("code",[e._v("ReactDOM.createBlockingRoot")]),e._v("和"),t("code",[e._v("ReactDOM.createRoot")]),e._v("创建的应用会采用"),t("code",[e._v("并发")]),e._v("的方式"),t("code",[e._v("更新状态")]),e._v("。")]),e._v(" "),t("p",[t("code",[e._v("高优更新")]),e._v("（红色节点）中断正在进行中的"),t("code",[e._v("低优更新")]),e._v("（蓝色节点），先完成"),t("code",[e._v("render - commit流程")]),e._v("。")]),e._v(" "),t("p",[e._v("待"),t("code",[e._v("高优更新")]),e._v("完成后，"),t("code",[e._v("低优更新")]),e._v("基于"),t("code",[e._v("高优更新")]),e._v("的结果"),t("code",[e._v("重新更新")]),e._v("。")]),e._v(" "),t("p",[e._v("接下来两节我们会从源码角度讲解这套"),t("code",[e._v("并发更新")]),e._v("是如何实现的。")]),e._v(" "),t("h2",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[e._v("#")]),e._v(" 参考资料")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://www.youtube.com/watch?v=v6iR3Zk4oDY",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("外网")]),e._v(" "),t("code",[e._v("英文")]),e._v(" React Core Team Dan 介绍 React 未来发展方向"),t("OutboundLink")],1)])])}),[],!1,null,null,null);v.default=a.exports}}]);